<b>University:</b> [ITMO University](https://itmo.ru/ru/) <br>
<b>Faculty:</b> [FTMI](https://ftmi.itmo.ru) <br>
<b>Course:</b> [Cloud platforms as the basis of technology entrepreneurship](https://itmo-ict-faculty.github.io/cloud-platforms-as-the-basis-of-technology-entrepreneurship/) <br>
<b>Year:</b> 2024/2025 <br>
<b>Group:</b> U4125 <br>
<b>Author:</b> Samedov Sultan Ilgar ogly <br>
<b>Lab:</b> Lab3 <br>
<b>Date of create:</b> 05.05.2025 <br>
<b>Date of finished:</b> 05.05.2025<br>

<h1>Отчет по лабораторной работе №3 </h1>
Описание заданий лабораторной работы можно найти здесь: https://itmo-ict-faculty.github.io/cloud-platforms-as-the-basis-of-technology-entrepreneurship/education/labs2023-2024/lab4/lab4/

<b>Этапы зрелости приложения:</b>

![image](https://github.com/user-attachments/assets/a166e9a7-9963-49d9-904c-88672227f397)


<b>Схема работы приложения</b>

![image](https://github.com/user-attachments/assets/56b96b7e-9aad-4715-8bee-837332344c50)

<b>Используемые ресурсы и их обоснование</b>

В обосновании выбора ресурсов для прототипа AI‑приложения ключевым является баланс между скоростью разработки, гибкостью масштабирования и контролем затрат. 
1.Для фронтенда Firebase Hosting обеспечивает мгновенный деплой на глобальный CDN с бесплатным SSL и встроенным кешированием, что позволяет минимизировать время выхода MVP на рынок и включить HTTPS «из коробки» ([Источник](https://medium.com/evenbit/gateway-to-firebase-hosting-dda81e83fcfa))

2.Обработка API‑запросов на Cloud Run обеспечивает полностью управляемую среду контейнеров с мгновенным автоскейлингом по запросам и моделью оплаты «pay-per-use», без необходимости управления серверами или кластером ([Источник](https://cloud.google.com/run/docs/overview/what-is-cloud-run))

3.Для хранения данных Firestore предоставляет серверless NoSQL‑базу с автоматической горизонтальной репликацией, бесплатным уровнем до 50 000 операций чтения/дня, что удобно для MVP и легко растёт при увеличении нагрузки ([Источник](https://cloud.google.com/run/docs/overview/what-is-cloud-run))

4.Для AI‑инференса Vertex AI (PaLM/Gemini) даёт доступ к более чем 200 предобученным моделям, полностью управляется Google и включает $300 кредитов на старте, что ускоряет интеграцию генерации маркетинговых отчётов без развёртывания собственной ML‑инфраструктуры ([Источник](https://cloud.google.com/vertex-ai)). 

5.Наконец, связка Cloud Logging и Cloud Monitoring обеспечивает единую платформу для сбора метрик, логов и трассировок, позволяет оперативно настраивать оповещения, строить дашборды и проводить post‑mortem анализ инцидентов.

![image](https://github.com/user-attachments/assets/7d08a5f8-603b-4be7-bcf1-a2c91318f1d5)

<b>Firebase Hosting</b>

Позволяет опубликовать статический фронтенд всего за одну команду CLI, сайт моментально распределяется по узлам Google — глобальный охват без настройки инфраструктуры.
Каждый кастомный домен получает сертификат HTTPS бесплатно и без ручного продления, что критично для безопасности пользовательских данных.

<b>Cloud Run</b>

Развернуть любой Docker‑образ можно без управления серверами, Google берёт на себя организацию кластеров, балансировку и патчинг ОС.
Инстансы мгновенно добавляются при росте трафика и сворачиваются до нуля при простое, что оптимизирует расходы под активность пользователей
Тарифы зависят от CPU/памяти и времени обработки запроса, без предоплаты за простаивающие ресурсы.

<b>Firestore</b>

Полностью управляемая база документов с синхронизацией в реальном времени и автоматическим шардированием, без дополнительных настроек кластеров и индексации.
Гарантирует устойчивость и низкую задержку в любой точке мира.
50 000 операций чтения, 20 000 записей и 1 GB хранилища в день без платы, что покрывает первоначальные тесты и разработку.

<b>Cloud Storage</b>

Тариф от $0.020 /GB/мес для Standard‑класса подходит для частого доступа к отчётам; Nearline/Coldline для архивных данных ещё дешевле. 
Можно гибко настраивать права доступа и ускорять скачивание отчётов за счёт Cloud CDN.

<b>Vertex AI (PaLM/Gemini)</b>

Полный цикл разработки моделей (от подготовки данных до развертывания), без необходимости администрировать инфраструктуру AI/ML.
PaLM 2 и Gemini готовы к генерации сложных текстов, классификации и суммаризации, что ускоряет создание маркетинговых отчётов «из коробки».
$300 бесплатных кредитов новым клиентам, а также интеграция с Vertex AI Studio для отладки и прототипирования запросов.

<b>Cloud Logging & Cloud Monitoring</b>

Сбор логов всех GCP‑сервисов в единое хранилище, авто‑захват логов контейнеров и VM через Ops Agent.
Мгновенная инжекция логов и метрик, настройка алертов на превышение пороговых значений, интеграция с Error Reporting и Trace для глубокого анализа.
Визуализация ключевых показателей на единой панели, что упрощает мониторинг производительности

<b>Модель затрат</b>

В Cloud Run есть возможность получить 180 000 vCPU‑секунд и 360 000 GiB‑секунд памяти бесплатно каждый месяц, что при 100 лёгких HTTP‑запросах укладывается в бесплатный лимит (запросы занимают порядка 0.5 сек на исполнение).
Firestore предоставляет ежедневно до 50 000 чтений, 20 000 записей, 20 000 удалений и 1 GiB хранения бесплатно, что при редком логировании и хранении истории чатов до 100 записей не генерирует дополнительных затрат (0–1 $/мес. на случай превышения).
Для Vertex AI (PaLM API) реальная стоимость при 100 текстовых запросах (по 1 к) составляет около 0.075 $ за 1 к входных токенов и 0.15 $ за 1 к выходных (в среднем ~100 к токенов итого), что дает 10 $/мес. при небольшом прототипе.
Cloud Storage (Standard‑класс) стоит ~0.020 $/GB/мес., и при хранении промотестовых отчётов (<1 GB) затраты составят ~0.02 $.
Firebase Hosting в Spark‑тарификационном плане даёт 1GB хранилища и 10 GB трафика бесплатно, чего достаточно для раздачи статического UI и небольшого объёма трафика на старте.

<h2> 1. Начальное состояние (до 100 запросов в месяц)</h2>

![image](https://github.com/user-attachments/assets/0fbecbd5-081b-4ef2-b1be-d8740c273ae1)

<h2> 2. Тестирование партнёрами (до 1000 запросов)</h2>

На стадии бета‑тестирования нагрузка возрастает, поэтому часть бесплатных квот в Cloud Run и Firestore уже исчерпывается, появляются расходы на инференс моделей в Vertex AI и на хранение/трафик в Cloud Storage. При учёте:

Cloud Run: небольшие перерасходы памяти/CPU‑секунд и сетевого трафика ($5), 
Firestore: 1 000 запросов + сопутствующие записи/чтения + рост хранения ($10).
Vertex AI: 1 000 вызовов генерации текста по 5 000 токенов => $60.
Cloud Storage: хранение и отдача отчётов (5 GiB) → $0.50.

<b>1. Cloud Run — $5</b>

Расширение использования beyond free tier
Free quota: 180 000 vCPU‑секунд и 450 000 GiB‑секунд памяти в месяц.
На этапе тестирования инстансы чаще «прогреваются» и занимаются более длительной обработкой (например, более тяжёлый JSON‑парсинг и логика A/B‑тестов), поэтому предполагаем перерасход ~10 000 GiB‑секунд памяти за квоту.
Сетевая передача данных
Cloud Run учитывает исходящий трафик: первые 1 GiB/мес бесплатно, далее ~$0,12/GiB.
1 000 ответов по 0,5 MiB (превью отчётов) ≈ 0,5 GiB → бесплатно; но учитываем доп. статистическую нагрузку и SDK → ≈ 1,5 GiB → $0,06.
Итоговая калькуляция
CPU/память: 10 000 GiB‑сек × $0,00000200 ≈ $20
Трафик: ≈ $0,06
Итого: $5

<b>2. Firestore — $10</b>

Операции чтения/записи
Free tier: 50 000 чтений и 20 000 записей в сутки.
При 1 000 сеансов по 2 записи и 2 чтения каждая формируется ~4 000 операций в месяц — остаётся в квоте.
Однако на этапе тестирования подключаются сложные запросы аналитики (индексные чтения) и логирование A/B, что может дать дополнительно до 1 млн операций/мес.
Стоимость операций	
Чтения: $0.06 за 100 000 → 1 000 000 чтений ≈ $0.60
Записи: $0,18 за 100 000 → 1 000 000 записей ≈ $1,80.
Индексные чтения и удаления: $0,02 за 100 000 → доп. ≈ $0,20.
Хранение данных
Free: 1 GiB, далее $0,18/GiB‑мес.
Логи и метаданные ≈ 5 GiB → $0,90.
Итог
Операции: $2,60
Хранилище: $0,90
Итого с запасом на дополнительные запросы: $10.

<b>3. Vertex AI — $60</b>

Токенная модель расчётов
PaLM/Gemini API тарифицируется по токенам: входные $0,003–$0,005 и выходные $0,015–$0,03 за 1 000 токенов.
Пример расчёта
1 000 запросов × среднее по 3 000 токенов ввода и 2 000 вывода = 5 000 000 токенов.
Стоимость: 5 000 × ($0,005 вход + $0,015 выход) = $100; однако при использовании PaLM 2 цены ниже ($0,003+0,01) → $65.
Учитываем бонусы и скидки
Пилотная фаза: 20 % скидка на Preview API.
Итого ориентировочно $60.

<b>4. Cloud Storage — $0,50</b>

Хранение
Standard‑класс: $0.020–$0.022 за GiB‑мес.
Партнёрское тестирование генерирует отчёты PDF/XLSX до 20 GiB → $0,40.
Сетевая отдача
Free tier: 1 GiB исходящего трафика/мес; далее $0.12/GiB.
20 GiB отдачи → первые 1 GiB бесплатно + 19 GiB × $0.12 = $2.28; но учитываем кэширование CDN, редкие загрузки → бюджетируем $0,10.
Итог 
Хранение $0,40 + отдача $0,10 = $0,50.

![image](https://github.com/user-attachments/assets/ff94bf36-9919-4772-81cb-3cc822ea075b)

Таким образом, при умеренном выходе за бесплатные квоты и с учётом реального потребления токенов, хранения и трафика, бета‑тестирование партнёрами обойдётся в $75/мес

<h2>3. Продовое решение (от 5000 запросов):</h2>

Cloud Run ($30): оплата за vCPU‑ и GiB‑секунды при высоком трафике.
Firestore ($30): плата за чтения/записи и хранение при интенсивном использовании.
Vertex AI ($600): токенные расчёты для генерации крупных отчётов.
Cloud Storage ($5): долговременное хранение и отдача больших объёмов PDF/XLSX.
Cloud Monitoring ($20): сбор метрик, алерты и дашборды при постоянном мониторинге.

1. Cloud Run — $30
Тарифы:
vCPU: $0,00001800 / vCPU‑сек beyond free tier (240 000 vCPU‑сек бесплатно)
Память: $0,00000200 / GiB‑сек beyond free tier (450 000 GiB‑сек бесплатно)
Запросы: 2 млн запросов бесплатно, далее $0,40 / млн вызовов 
Расчёт:
При 5 000 запросах по 1 сек CPU и 0.5 GiB памяти:
CPU: 5 000 vCPU‑сек · $0,000018 = $0,09
Память: 2 500 GiB‑сек · $0,000002 = $0,005
Даже при учёте резервных инстансов и пиков: ~$30/мес для гарантированного минимума (например, 10 000 vCPU‑сек) 
Обоснование: при росте до сотен параллельных соединений важно держать резерв минимальных инстансов, что создаёт базовую оплату ~$20/мес.

2. Firestore — $30
Free tier: 50 000 чтений, 20 000 записей, 1 GiB хранения в день
Плата сверх квоты:
Чтения: $0,06 / 100 000 
Записи: $0,18 / 100 000
Хранилище: $0,18 / GiB‑мес
Расчёт:
5 000 сессий × 4 операции (2 чтения + 2 записи) = 20 000 операций → укладывается в free tier.
Дополнительно аналитика и дашборды: ещё ~5 000 000 операций →
5 000 000 чтений → $3,00
5 000 000 записей → $9,00
Хранение данных (5 GiB) → $0,90
Итого: ~ $30/мес.

3. Vertex AI — $600
Тарифы PaLM/Gemini API (пример для PaLM 2):
Входные токены: $0,003 / 1 000 токенов
Выходные токены: $0,01 / 1 000 токенов
Расчёт:
5 000 запросов × среднее 5 000 токенов (ввод+вывод) = 25 млн токенов →  25 000 × ($0,003 + $0,01) = $325
При использовании более сложных моделей или больших ответов (8 000 токенов) — до $600
Обоснование: генерация маркетинговых отчётов — тяжёлая LLM‑нагрузка; именно здесь идут основные расходы.

4. Cloud Storage — $5
Тарифы Standard: $0,020 / GiB‑мес; Nearline/Coldline ещё дешевле 
Операции (Class A/B): $0,01 / 1 000 и $0,0004 / 1 000 соответственно 
Сетевой egress: $0,12 / GiB сверх 5 GiB free tier
Расчёт:
Хранение: 100 GiB отчётов → $2,00
Отдача: 20 GiB egress → $ (5 GiB free + 15 GiB*0,12) = $1,80
Операции: ~500 000 Class B → $0,20
Итого:  $5/мес.

5. Cloud Monitoring — $27,9
Плата за метрики:
Бесплатно первые 150 MiB метрик/мес, далее $0,258 / MiB
Alerting: $1.50/условие + $0,35/млн time series
Расчёт:
10 условий алертов → $15,00
Метрики: 100 MiB сверх free tier → $12,90
Итого: $27,9 (с учётом смешения периодов и агрегации).

Итоговая модель затрат


